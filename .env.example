# =============================================================================
# Rentbot — Environment Configuration Example
# =============================================================================
# Copy this file to `.env` and fill in the real values.
#
#   cp .env.example .env
#
# Variables marked REQUIRED must be set before the bot will start.
# Variables with defaults listed are optional — the defaults are applied if
# the variable is absent.
# =============================================================================


# -----------------------------------------------------------------------------
# Telegram
# -----------------------------------------------------------------------------

# REQUIRED. Bot token issued by @BotFather.
TELEGRAM_BOT_TOKEN=

# REQUIRED. Numeric chat ID to which alerts are sent (user or group chat).
# To find your chat ID, send a message to your bot then call:
#   https://api.telegram.org/bot<token>/getUpdates
TELEGRAM_CHAT_ID=

# Delay (seconds) between consecutive Telegram messages to stay under the
# ~30 msgs/sec rate limit during bulk alert bursts.  Default: 0.05
TELEGRAM_SEND_DELAY=0.05


# -----------------------------------------------------------------------------
# LLM (used for unstructured source classification — e.g. Facebook posts)
# -----------------------------------------------------------------------------

# OpenAI API key. Used when LLM_PROVIDER=openai (default).
# Leave blank to disable LLM-based classification entirely.
OPENAI_API_KEY=

# Anthropic API key. Used only when LLM_PROVIDER=anthropic.
ANTHROPIC_API_KEY=

# Which LLM backend to use. Options: openai | anthropic.  Default: openai
LLM_PROVIDER=openai

# Model name within the chosen provider.
# openai default: gpt-4o-mini  |  anthropic default: claude-3-haiku-20240307
LLM_MODEL=gpt-4o-mini

# Maximum tokens in a single LLM completion.  Default: 256
LLM_MAX_TOKENS=256


# -----------------------------------------------------------------------------
# Facebook (browser worker — requires Playwright)
# -----------------------------------------------------------------------------

# Facebook account email used for authenticated scraping.
FACEBOOK_EMAIL=

# Facebook account password.
FACEBOOK_PASSWORD=

# Path to a Playwright storage-state JSON file (saved cookies/session).
# When set, login is skipped and the saved session is restored instead.
# Relative paths are resolved from the project root.  Default: (none)
FACEBOOK_SESSION_PATH=

# Comma-separated list of Facebook group IDs or slugs to monitor.
# Example: 1234567890,affitti-pordenone
FACEBOOK_GROUP_IDS=

# Number of most-recent posts to inspect per group per cycle.  Default: 5
FACEBOOK_POST_LIMIT=5


# -----------------------------------------------------------------------------
# Immobiliare.it
# -----------------------------------------------------------------------------

# Semicolon-separated lat,lng polygon vertices for the geo search filter.
# Capture this value from the Network tab (Fetch/XHR) on the Immobiliare.it
# search-results page — look for the "vrt" query parameter.
# Example (Pordenone area): 46.0,12.6;46.0,12.7;45.9,12.7;45.9,12.6;46.0,12.6
# Leave empty to disable the Immobiliare provider.
IMMOBILIARE_VRT=

# Maximum number of result pages to fetch per poll cycle.  Default: 3
IMMOBILIARE_MAX_PAGES=3


# -----------------------------------------------------------------------------
# Casa.it
# -----------------------------------------------------------------------------

# Full URL of the Casa.it search-results page to monitor.
# Navigate to your target area on casa.it, apply your filters (rent, category,
# city), and copy the resulting URL from the address bar.
# Example (Pordenone, residential, rent):
#   https://www.casa.it/affitto/residenziale/pordenone/
# Leave empty to disable the Casa provider.
CASA_SEARCH_URL=

# Maximum number of result pages to fetch per poll cycle.  Default: 3
CASA_MAX_PAGES=3


# -----------------------------------------------------------------------------
# Search parameters (applied to all providers unless overridden per-provider)
# -----------------------------------------------------------------------------

# City / search area. Used by API providers to scope the query.
SEARCH_CITY=Pordenone

# Maximum monthly rent in EUR (inclusive).  Default: 800
SEARCH_MAX_PRICE=800

# Minimum monthly rent in EUR (inclusive, 0 = no lower bound).  Default: 0
SEARCH_MIN_PRICE=0

# Minimum number of rooms (locali).  Default: 2
SEARCH_MIN_ROOMS=2

# Maximum number of rooms (0 = no upper bound).  Default: 0
SEARCH_MAX_ROOMS=0

# Minimum floor area in m².  Default: 0
SEARCH_MIN_AREA=0

# Comma-separated keywords whose presence in a title/description causes the
# listing to be rejected (case-insensitive).  Example: garage,box,posto auto
SEARCH_KEYWORD_BLOCKLIST=garage,box,posto auto,magazzino,deposito


# -----------------------------------------------------------------------------
# Per-provider overrides (optional; falls back to global SEARCH_* values)
# -----------------------------------------------------------------------------

# IMMOBILIARE_MAX_PRICE=
# CASA_MAX_PRICE=
# SUBITO_MAX_PRICE=


# -----------------------------------------------------------------------------
# Storage
# -----------------------------------------------------------------------------

# Path to the SQLite database file.  Default: data/rentbot.db
# In Docker, point this at the mounted volume (e.g. /data/rentbot.db).
DATABASE_PATH=data/rentbot.db


# -----------------------------------------------------------------------------
# Polling intervals
# -----------------------------------------------------------------------------

# Seconds between polls for API-based providers (immobiliare, casa, subito).
# Actual interval is randomized in the range [MIN, MAX] each cycle.
# Defaults: 300 (5 min) – 600 (10 min)
POLL_INTERVAL_API_MIN=300
POLL_INTERVAL_API_MAX=600

# Seconds between polls for browser-based providers (facebook, idealista).
# Defaults: 900 (15 min) – 1200 (20 min)
POLL_INTERVAL_BROWSER_MIN=900
POLL_INTERVAL_BROWSER_MAX=1200


# -----------------------------------------------------------------------------
# Runtime behaviour
# -----------------------------------------------------------------------------

# Set to "true" to run in seed mode: populate the DB with current listings
# without sending any Telegram alerts. Use on first run to avoid a flood.
# Default: false
SEED_MODE=false

# Set to "true" to log alert payloads without actually sending Telegram
# messages. Useful for local development.  Default: false
DRY_RUN=false

# Python logging level: DEBUG | INFO | WARNING | ERROR.  Default: INFO
LOG_LEVEL=INFO

# Structured log format: text | json.  Default: text
LOG_FORMAT=text
